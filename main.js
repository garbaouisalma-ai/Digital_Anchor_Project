/**
 * =================================================================
 * 1. ุจูุงูุงุช ุงูุชุฑุฌูุฉ (Translation Data)
 * ุชู ุฏูุฌ ุฌููุน ุงูููุงุชูุญ ูู index, track-sovereignty, resources, thank-you
 * =================================================================
 */
const translations = {
    'ar': {
        // ููุงุชูุญ index.html
        'page_title': 'ูู ุฃูุช ุญูู ุชูุทูุฆ ุงูุดุงุดุฉุ | ุงููุฑุณุงุฉ ุงูุฑูููุฉ',
        'site_name': 'ุงููุฑุณุงุฉ ุงูุฑูููุฉ', 
        'nav_tracks': 'ุงููุณุงุฑุงุช', 
        'nav_dashboard': 'ููุญุฉ ุงูููุงุฏุฉ', 
        'nav_blog': 'ุงููุฏููุฉ', 
        'nav_join': 'ุงุญุฌุฒ ุงููุชุงุจ',
        'hero_badge': 'โจ ุงูุฅุตุฏุงุฑ ุงูุฌุฏูุฏ 2025', 
        'hero_title': 'ูู ุฃูุช ุญูู <span class="text-yellow-300">ุชูุทูุฆ ุงูุดุงุดุฉ</span>ุ',
        'hero_subtitle': 'ุฏููู ุงูุดุจุงุจ ููููู ูุงูุชุฑููุฒ ูุงููุฏู ูู ุงูุชุตุงุฏ ุงูุงูุชุจุงู.',
        'hero_btn_start': 'ุงุญุฌุฒ ุงููุชุงุจ ูุงูุฑุญูุฉ ุงูุขู', 
        'hero_btn_emergency': 'ุฏููู ุงูุทูุงุฑุฆ',
        'author_label': 'ุนู ุงููุคููุฉ', 
        'author_name': 'ููุงู ุบุฑุจุงูู', 
        'author_bio': 'ุฑุงุฆุฏุฉ ูู ูุฌุงู ุงูุชุญูู ุงูุฑููู ุงููุงุนูุ ูุฎุจูุฑุฉ ูู ููุงุฌูุฉ ุชุญุฏูุงุช ุงูุชุดุชุช ุงูุฑููู. ูุฐุง ุงููุชุงุจ ูู ููุจุน ูู ุฏุฑุงุณุงุช ุฃูุงุฏูููุฉ ูุญุณุจุ ุจู ูู ุชุฌุฑุจุฉ ุดุฎุตูุฉ ุนูููุฉ ูู ุงุณุชุนุงุฏุฉ ุงูุณูุทุฑุฉ ุนูู ุงูููุช ูุงูููู.',
        'roadmap_title': 'ุจุฑูุงูุฌ ุงูู 90 ูููุงู', 
        'roadmap_desc': 'ุฎุทุฉ ุนูููุฉ ูุชุญููู ุงููุนู ุงูุฑููู ุฅูู ููุงุฑุณุฉ ููููุฉ.',
        'month1_title': 'ุงูุดูุฑ 1: ุงูุตุญูุฉ ุงูุฑูููุฉ', 'month1_goal': 'ุงููุฏู: ุฎูุถ ุงูุฅููุงุก ุจูุณุจุฉ 30%',
        'month2_title': 'ุงูุดูุฑ 2: ุจูุงุก ุงููุธุงู', 'month2_goal': 'ุงููุฏู: ุฅูุดุงุก ูุธุงู ุฅูุชุงุฌูุฉ ูุณุชุฏุงู',
        'month3_title': 'ุงูุดูุฑ 3: ุงูุชุฃุซูุฑ', 'month3_goal': 'ุงููุฏู: ูุณุงุนุฏุฉ ุดุฎุต ูุงุญุฏ',
        'tools_title': 'ุฃุฏูุงุช ูุฌุงููุฉ ูุชุจุฏุฃ ุงูุขู', 
        'pledge_title': 'ุชุนูุฏ ุงูุณูุงุฏุฉ ุงูุฑูููุฉ', 
        'pledge_text': '"ุฃุชุนูุฏ ุฃูุงู ููุณู ุจุฃู ุชููู ุงูููู ุงูุฎูุณ ุงูุชู ุฃุคูู ุจูุง ูู ุงูููุชุฑ ุงูุฃุณุงุณู ูุฌููุน ูุฑุงุฑุงุชู ุงูููููุฉุ ุฎุงุตุฉ ูู ุงูุนุงูู ุงูุฑููู."', 
        'pledge_btn': 'ุฃููุน ุงูุนูุฏ ุงูุขู โ๏ธ',
        'btn_free_tools': 'ุงูุชุดู ุงูููุชุจุฉ ุงููุฌุงููุฉ',

        // ููุงุชูุญ track-sovereignty.html
        'nav_home': 'ุงูุฑุฆูุณูุฉ', // ููุชุงุญ ูุดุชุฑู
        'track_badge': 'ุงููุณุงุฑ ุงูุฃูู: ุงูุฃุณุงุณ', 
        'track_title': 'ูุณุงุฑ ุงูุณูุงุฏุฉ ุงูุฑูููุฉ ๐ก๏ธ', 
        'track_subtitle': 'ุงุณุชุนุฏ ุงูุชุจุงูู ูููุชู ููููุชู ูู ุฑุญูุฉ ููุฌูุฉ ููุฏุฉ 90 ูููุงู.', 
        'meta_weeks': '13 ุฃุณุจูุนุงู', 'meta_time': '60 ุฏูููุฉ/ููู',
        'outcomes_header': 'ููุงุฐุง ูุฐุง ุงููุณุงุฑุ', 'outcome_1': 'ุฎูุถ ุงูุชุดุชุช', 'outcome_1_desc': 'ุจูุณุจุฉ 50% ุนูู ุงูุฃูู', 
        'outcome_2': 'ูุธุงู ุงูุฃูุฏุงู', 'outcome_2_desc': 'ุจูุงุก ูุธุงู ุฅูุชุงุฌูุฉ ุดุฎุตู', 
        'outcome_3': 'ุงูุณูุงู ุงูุฏุงุฎูู', 'outcome_3_desc': 'ุงูุชุญุฑุฑ ูู FOMO',
        'roadmap_header': 'ุฎุฑูุทุฉ ุงูุฑุญูุฉ ุงูุชูุตูููุฉ', 
        'phase1_title': 'ุงููุฑุญูุฉ 1: ุงูุตุญูุฉ (ุฃุณุงุจูุน 1-4)', 'phase1_desc': 'ุชุดุฎูุต ุงููุงูุนุ ุงูุชุดุงู "ุงููุฑุณุงุฉ" (ุงูููู)ุ ูุจูุงุก ุงูุญุตุงูุฉ ุงูุฏุงุฎููุฉ.', 'phase1_btn': 'ุงุจุฏุฃ ุงูุฃุณุจูุน ุงูุฃูู &larr;',
        'phase2_title': 'ุงููุฑุญูุฉ 2: ุงูุจูุงุก (ุฃุณุงุจูุน 5-8)', 'phase2_desc': 'ุชุญููู ุงูุฃุญูุงู ุฅูู ุฃูุฏุงู ุฐููุฉ (ุงูุณูู)ุ ููุฏุณุฉ ุงูุจูุฆุฉุ ูุงุณุชุฑุงุชูุฌูุฉ ุงูุชุนุงูู ูุน ุงููุดู.',
        'phase3_title': 'ุงููุฑุญูุฉ 3: ุงูุชูููู (ุฃุณุงุจูุน 9-13)', 'phase3_desc': 'ููู ุงูุชุตุงุฏ ุงูุงูุชุจุงูุ ุฅุชูุงู ุฅุฏุงุฑุฉ ุงูููุชุ ูุงูุชุชููุฌ ุจูุดุฑูุน ุงูุชุฃุซูุฑ ุงููุฌุชูุนู.',
        'tools_support_header': 'ุงูุฃุฏูุงุช ูุงูุฏุนู', 'tool1': 'ุฏูุชุฑ ุงูุณูุงุฏุฉ', 'tool2': 'ูููุงุณ ูุงูุนู', 'tool3': 'ูุฌุชูุน ุงูุฏุนู', 'tool4': 'ููุงุก ุงูุฎููุณ ุงูุญู',
        'pricing_header': 'ุงุฎุชุฑ ุงุณุชุซูุงุฑู ูู ููุณู', 'plan1_title': 'ุงููุณุฎุฉ ุงูุฐุงุชูุฉ', 'plan1_desc': 'ูุตูู ูุงูู ููููุงุฏุ ุฏุนู ุงููุฌุชูุน ุงูุนุงู.', 
        'plan2_title': 'ุงููุณุฎุฉ ุงูููุฌูุฉ', 'plan2_desc': 'ุจุงูุฅุถุงูุฉ ุฅูู 4 ุฌูุณุงุช ุชูุฌูู ูุฑุฏูุฉ ูุชุตุญูุญ ุงููุงุฌุจุงุช.', 'plan_btn': 'ุงุฎุชุฑ ุงูุฎุทุฉ',
        'faq_header': 'ุฃุณุฆูุฉ ุดุงุฆุนุฉ', 'footer_copy': 'ยฉ 2025 Digital Anchor Academy. ุฌููุน ุงูุญููู ูุญููุธุฉ.', 
        
        // ููุงุชูุญ resources.html
        'nav_book_now': 'ุงุญุฌุฒ ุงููุชุงุจ',
        'header_title': 'ุงูููุชุจุฉ ุงููุฌุงููุฉ',
        'header_subtitle': 'ุฃุฏูุงุชุ ูุนููุงุชุ ูููุตูุงุช ูุชุฐููุฑู ุจูููู ุงูุฑูููุฉ ููููุงู.',
        'posters_title': '๐ผ๏ธ ุงููุนููุงุช ุงูุฌุฏุงุฑูุฉ',
        'posters_desc': 'ุตููุช ููุทุจุงุนุฉ ูุชุนููููุง ูู ุบุฑูุชู ุฃู ููุชุจู.',
        'p1_title': 'ููุทูุฉ ุงูุณูุงุฏุฉ ุงูุดุฎุตูุฉ', 'p1_desc': 'ููุตู ูุชุฐููุฑู ุจุงูููุงุทู ุงูุฎุงููุฉ ูู ุงููุงุชู.', 'p1_img_text': 'ููุทูุฉ ูุญุธูุฑุฉ',
        'p2_title': 'ุงูุตู ูุชุชุตู', 'p2_desc': 'ุชุฐููุฑ ุจุฃู ุงูุญูุงุฉ ุงูุญููููุฉ ุชุญุฏุซ ุจุนูุฏุงู ุนู ุงูุดุงุดุฉ.', 'p2_img_text': 'ุงูุตู.. ูุชุชุตู',
        'p3_title': 'ุจูุตูุฉ ุงูุงูุชุจุงู', 'p3_desc': 'ูู ูุง ุชูุนูู ุงูุขู ูุฎุฏู ูุฏู ุงูู 5 ุณููุงุชุ', 'p3_img_text': 'ุฃูู ุงูุชุจุงููุ',
        'btn_download': 'ุชุญููู (PDF)',
        'tool1_title': 'ุฏููู ุงูุทูุงุฑุฆ ุงูุฑููู', 'tool1_desc': 'ููุญุธุงุช ุงูุถุนู ูุงูุนูุฏุฉ ููุฅุฏูุงู.',
        'tool2_title': 'ุฏููู ุงููููุฌูุฉ (40/40/20)', 'tool2_desc': 'ููู ุชุชุนูู ุจุฐูุงุก ูุชุทุจู ูุง ุชุชุนููู.',
        'stickers_title': 'โจ ููุตูุงุช ุงููุงุจุชูุจ ูุงููุงุชู',
        'sticker_text': 'ุฃูุง ุงููุจุทุงู',
        'btn_print': 'ุทุจุงุนุฉ ุงูููุตูุงุช',

        // ููุงุชูุญ thank-you-preorder.html (ุชู ุฏูุฌูุง ูู ูููุงุช HTML React)
        // 'thankyou_title': 'ุดูุฑุงู ูุทูุจู', 
        // 'thanks_header': 'ุชู ุชุฃููุฏ ุทูุจู ุจูุฌุงุญ!', 
        // 'thanks_subtitle': 'ุดูุฑุงู ููููู ุฌุฒุกุงู ูู ุนุงุฆูุฉ ุงููุฑุณุงุฉ ุงูุฑูููุฉ. ุณูุฑุณู ูู ุชูุงุตูู ุงูุฏุฎูู ุนุจุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุฑูุจุงู.',
        // 'gift_title': 'ูุฏูุฉ ุงูุญุฌุฒ ุงููุณุจู:', 'gift_desc': 'ูุตูู ููุฑู ููุฌุงูู ูุฃุฏุงุฉ ุชุญุฏูุฏ ุงูููู.',
        // 'btn_tool': 'ุฌุฑุจ ุงูุฃุฏุงุฉ ุงูุขู', 'btn_home': 'ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ'
    },
    'en': {
        // ููุงุชูุญ index.html
        'page_title': 'Who are you when the screen goes off? | Digital Anchor', 
        'site_name': 'Digital Anchor', 
        'nav_tracks': 'Tracks', 
        'nav_dashboard': 'Dashboard', 
        'nav_blog': 'Blog', 
        'nav_join': 'Order Book',
        'hero_title': 'Who are you when the screen <span class="text-yellow-300">goes off</span>?', 
        'hero_subtitle': 'A guide to values, focus, and purpose in the attention economy.',
        'hero_badge': 'โจ New Edition 2025',
        'hero_btn_start': 'Order Book & Journey Now', 
        'hero_btn_emergency': 'Emergency Guide',
        'author_label': 'About the Author', 
        'author_name': 'Nawal Gharbawi', 
        'author_bio': 'A pioneer in conscious digital transformation. This book emerged from deep personal experience in regaining control over time and values.',
        'roadmap_title': 'The 90-Day Program', 
        'roadmap_desc': 'A practical roadmap to turn digital awareness into daily practice.',
        'month1_title': 'Month 1: Digital Awakening', 'month1_goal': 'Goal: Reduce distraction by 30%',
        'month2_title': 'Month 2: System Building', 'month2_goal': 'Goal: Sustainable productivity system',
        'month3_title': 'Month 3: Impact', 'month3_goal': 'Goal: Help one person',
        'tools_title': 'Free Tools to Start Now', 
        'pledge_title': 'Digital Sovereignty Pledge', 
        'pledge_text': '"I pledge to myself that my core values will be the primary filter for all my daily decisions, especially in the digital world."', 
        'pledge_btn': 'Sign Pledge Now โ๏ธ',
        'btn_free_tools': 'Discover Free Library',

        // ููุงุชูุญ track-sovereignty.html
        'nav_home': 'Home', 
        'track_badge': 'Track 1: The Foundation', 
        'track_title': 'Digital Sovereignty Track ๐ก๏ธ', 
        'track_subtitle': 'Reclaim your attention, time, and value in a 90-day guided journey.', 
        'meta_weeks': '13 Weeks', 'meta_time': '60 min/Day',
        'outcomes_header': 'Why This Track?', 'outcome_1': 'Reduce Distraction', 'outcome_1_desc': 'By at least 50%', 
        'outcome_2': 'Goal System', 'outcome_2_desc': 'Build a personal productivity system', 
        'outcome_3': 'Inner Peace', 'outcome_3_desc': 'Freedom from FOMO',
        'roadmap_header': 'Detailed Journey Map', 
        'phase1_title': 'Phase 1: Awakening (Wk 1-4)', 'phase1_desc': 'Diagnosis, discovering your "Anchor" (Values), and building internal immunity.', 'phase1_btn': 'Start Week 1 &larr;',
        'phase2_title': 'Phase 2: Building (Wk 5-8)', 'phase2_desc': 'SMART goals, environment engineering, and failure strategy.',
        'phase3_title': 'Phase 3: Empowerment (Wk 9-13)', 'phase3_desc': 'Understanding the attention economy, time mastery, and the impact project.',
        'tools_support_header': 'Tools & Support', 'tool1': 'Sovereignty Workbook', 'tool2': 'Reality Scale', 'tool3': 'Support Community', 'tool4': 'Live Webinar',
        'pricing_header': 'Invest In Yourself', 'plan1_title': 'Self-Paced', 'plan1_desc': 'Full material access, general community support.', 
        'plan2_title': 'Guided Version', 'plan2_desc': 'Includes 4 individual coaching sessions and assignment correction.', 'plan_btn': 'Choose Plan',
        'faq_header': 'FAQ', 'footer_copy': 'ยฉ 2025 Digital Anchor Academy. All Rights Reserved.', 
        
        // ููุงุชูุญ resources.html
        'nav_book_now': 'Order Book',
        'header_title': 'Free Library',
        'header_subtitle': 'Tools, posters, and stickers to remind you of your digital values daily.',
        'posters_title': '๐ผ๏ธ Wall Posters',
        'posters_desc': 'Designed to be printed and hung in your room or office.',
        'p1_title': 'Sovereignty Zone', 'p1_desc': 'A reminder of phone-free zones.', 'p1_img_text': 'No Phone Zone',
        'p2_title': 'Disconnect to Connect', 'p2_desc': 'Real life happens away from the screen.', 'p2_img_text': 'Connect',
        'p3_title': 'Attention Compass', 'p3_desc': 'Does this serve your 5-year goal?', 'p3_img_text': 'Focus?',
        'btn_download': 'Download (PDF)',
        'tool1_title': 'Digital Emergency Guide', 'tool1_desc': 'For moments of weakness and relapse.',
        'tool2_title': 'Methodology Guide', 'tool2_desc': 'How to learn smart and apply.',
        'stickers_title': 'โจ Laptop & Phone Stickers',
        'sticker_text': 'I am Captain',
        'btn_print': 'Print Stickers'
    },
    // ููููู ุฅุถุงูุฉ ุงููุบุงุช 'fr' ู 'de' ููุง ุจููุณ ุงููููููุฉ
};

/**
 * =================================================================
 * 2. ุจูุงูุงุช ุงูุนููุงุช (Currency Data)
 * =================================================================
 */
const RATES = { 
    'SAR': { r: 1, s: 'SAR' }, 
    'USD': { r: 0.27, s: '$' }, 
    'EUR': { r: 0.25, s: 'โฌ' } 
};

/**
 * =================================================================
 * 3. ุฏุงูุฉ ุชุญููู ุงูุนููุฉ (Currency Conversion)
 * =================================================================
 */
function convertCurrency(curr) {
    const rate = RATES[curr].r;
    const symbol = RATES[curr].s;
    
    // ุชุญุฏูุซ ูู ุงูุนูุงุตุฑ ุงูุชู ุชุญูู ุงููุฆุฉ price-display
    document.querySelectorAll('.price-display').forEach(el => {
        const base = el.getAttribute('data-base-price');
        // ุงูุชุฃูุฏ ูู ุฃู ุงููููุฉ ุงูุฃุณุงุณูุฉ ุฑูู
        if (base) {
            el.textContent = Math.round(base * rate);
        }
    });
    
    // ุชุญุฏูุซ ุฑูุฒ ุงูุนููุฉ
    document.querySelectorAll('.currency-symbol').forEach(el => {
        el.textContent = symbol;
    });
    
    // ุชุญุฏูุซ ุงูููุงุฆู ุงูููุณุฏูุฉ ููุนููุฉ
    document.querySelectorAll('#curr-select').forEach(select => { 
        if(select) select.value = curr; 
    });
    
    // ุญูุธ ุงูุนููุฉ ุงูููุถูุฉ
    localStorage.setItem('preferredCurr', curr);
}

/**
 * =================================================================
 * 4. ุฏุงูุฉ ุชุบููุฑ ุงููุบุฉ (Language Switching)
 * =================================================================
 */
function setLanguage(lang) {
    const isRTL = lang === 'ar';
    document.documentElement.setAttribute('dir', isRTL ? 'rtl' : 'ltr');
    document.documentElement.setAttribute('lang', lang);
    
    // ุชุทุจูู ุงูุชุฑุฌูุงุช
    document.querySelectorAll('[data-key]').forEach(el => {
        const key = el.getAttribute('data-key');
        if (translations[lang] && translations[lang][key]) {
            // ุงุณุชุฎุฏุงู innerHTML ููุณูุงุญ ุจุงููุณูู ุงูุฏุงุฎููุฉ ูุซู <span> ูู ุงูุนููุงู ุงูุฑุฆูุณู
            el.innerHTML = translations[lang][key]; 
        }
    });

    // ุชุญุฏูุซ ุงูููุงุฆู ุงูููุณุฏูุฉ ููุบุฉ
    document.querySelectorAll('#lang-select').forEach(select => { 
        if(select) select.value = lang; 
    });
    
    // ูุญุงุฐุงุฉ ุงููุต
    document.body.style.textAlign = isRTL ? 'right' : 'left';
    
    // ุญูุธ ุงููุบุฉ ุงูููุถูุฉ
    localStorage.setItem('preferredLang', lang);

    // ุฅุฐุง ูุงูุช ุงูุตูุญุฉ ุชุญุชูู ุนูู ุฃุณุนุงุฑ (ูุซู track-sovereignty)ุ ูููู ุจุชุญุฏูุซ ุงูุนููุฉ
    if (document.querySelector('.price-display')) {
        const preferredCurr = localStorage.getItem('preferredCurr') || 'SAR';
        convertCurrency(preferredCurr);
    }
}

// ุฌุนู ุงูุฏูุงู ูุชุงุญุฉ ุนุงูููุงู ููุชููู ุงูู HTML ูู ุงุณุชุฏุนุงุฆูุง (onchange)
window.setLanguage = setLanguage; 
window.convertCurrency = convertCurrency;

/**
 * =================================================================
 * 5. ูุธููุฉ ูุงุฆูุฉ ุงูููุจุงูู (Mobile Menu)
 * =================================================================
 */
function setupMobileMenu() {
    const menuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    
    if (menuBtn && mobileMenu) {
        menuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
            
            // ุชุบููุฑ ุฃููููุฉ ุงูุฒุฑ
            const icon = menuBtn.querySelector('i');
            if (icon) {
                if (mobileMenu.classList.contains('hidden')) {
                    icon.classList.remove('fa-times'); // ุฅุบูุงู
                    icon.classList.add('fa-bars'); // ูุชุญ
                } else {
                    icon.classList.remove('fa-bars');
                    icon.classList.add('fa-times'); 
                }
            }
        });
    }
}

/**
 * =================================================================
 * 6. ุงูุชุดุบูู ุนูุฏ ุงูุชุญููู (Initialization)
 * =================================================================
 */
document.addEventListener('DOMContentLoaded', () => {
    // 6.1 ุฅุนุฏุงุฏ ูุงุฆูุฉ ุงูููุจุงูู
    setupMobileMenu();
    
    // 6.2 ุชุทุจูู ุงููุบุฉ ุงูููุถูุฉ ุนูุฏ ุชุญููู ุงูุตูุญุฉ
    const defaultLang = localStorage.getItem('preferredLang') || 'ar';
    setLanguage(defaultLang);
});