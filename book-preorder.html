<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-key="page-title">ÿßÿ≠ÿ¨ÿ≤ ŸÉÿ™ÿßÿ® "ŸÖŸÜ ÿ£ŸÜÿ™ ÿ≠ŸäŸÜ ÿ™ŸÜÿ∑ŸÅÿ¶ ÿßŸÑÿ¥ÿßÿ¥ÿ©ÿü"</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'anchor-blue': '#0f172a',
                        'anchor-gold': '#d4af37',
                        'anchor-green': '#059669'
                    },
                    fontFamily: {
                        sans: ['Tajawal', 'sans-serif'],
                        serif: ['Amiri', 'serif']
                    }
                }
            }
        }
    </script>
    
    <script crossorigin src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-slate-50 text-slate-900 font-sans">
    <div id="root" class="flex flex-col min-h-screen w-full"></div>

    <script type="text/babel">
        const { useState, useEffect, createContext, useContext, useMemo } = React;

        // =====================================
        // 1. ŸÇÿßŸÖŸàÿ≥ ÿßŸÑÿ™ÿ±ÿ¨ŸÖÿ© (AR Ÿà EN ŸÅŸÇÿ∑)
        // =====================================
        const ALL_TRANSLATIONS = {
            'site-logo': { ar: 'ÿßŸÑŸÖÿ±ÿ≥ÿßÿ© ÿßŸÑÿ±ŸÇŸÖŸäÿ©', en: 'Digital Anchor' },
            'nav-home': { ar: 'ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©', en: 'Home' },
            'nav-guide': { ar: 'ÿßŸÑÿØŸÑŸäŸÑ', en: 'Guide' },
            'nav-resources': { ar: 'ÿßŸÑŸÖŸàÿßÿ±ÿØ', en: 'Resources' },
            'nav-members': { ar: 'ÿßŸÑÿ£ÿπÿ∂ÿßÿ°', en: 'Members' },
            'nav-buy': { ar: 'ÿßÿ≠ÿ¨ÿ≤ ŸÜÿ≥ÿÆÿ™ŸÉ', en: 'Pre-order' },
            'page-title': { ar: 'ÿßÿ≠ÿ¨ÿ≤ ŸÉÿ™ÿßÿ® "ŸÖŸÜ ÿ£ŸÜÿ™ ÿ≠ŸäŸÜ ÿ™ŸÜÿ∑ŸÅÿ¶ ÿßŸÑÿ¥ÿßÿ¥ÿ©ÿü"', en: 'Pre-order "Who are you when the screen turns off?"' },
            'header-title': { ar: 'ÿßÿ∑ŸÑÿ® ŸÜÿ≥ÿÆÿ™ŸÉ ÿßŸÑÿ¢ŸÜ', en: 'Order Your Copy Now' },
            'header-subtitle': { ar: 'ÿßÿ≥ÿ™ÿ´ŸÖÿ± ŸÅŸä ÿ≥ŸäÿßÿØÿ™ŸÉ ÿßŸÑÿ±ŸÇŸÖŸäÿ©. ÿ•ÿ∑ŸÑÿßŸÇ ÿßŸÑÿ•ÿµÿØÿßÿ± ŸÅŸä ÿßŸÑÿ±ÿ®ÿπ ÿßŸÑÿ£ŸàŸÑ 2026.', en: 'Invest in your digital sovereignty. Release in Q1 2026.' },
            'product-title': { ar: 'ÿ≠ÿ¨ÿ≤ ŸÉÿ™ÿßÿ®: ŸÖŸÜ ÿ£ŸÜÿ™ ÿ≠ŸäŸÜ ÿ™ŸÜÿ∑ŸÅÿ¶ ÿßŸÑÿ¥ÿßÿ¥ÿ©ÿü', en: 'Book Pre-order: Who are you when the screen turns off?' },
            'product-feature-1': { ar: 'ÿßŸÑŸÉÿ™ÿßÿ® ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä ÿßŸÑŸÉÿßŸÖŸÑ (Ÿäÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑŸá ŸÅŸàÿ±ÿßŸã)', en: 'The complete e-book (sent immediately)' },
            'product-feature-2': { ar: 'ŸÜÿ≥ÿÆÿ© Ÿàÿ±ŸÇŸäÿ© ŸÅÿßÿÆÿ±ÿ© (ÿ™Ÿèÿ¥ÿ≠ŸÜ ŸÑÿßÿ≠ŸÇÿßŸã)', en: 'Deluxe physical copy (shipped later)' },
            'product-feature-3': { ar: 'ŸàÿµŸàŸÑ ÿ•ŸÑŸâ ŸÖŸÉÿ™ÿ®ÿ© ÿßŸÑÿ£ÿπÿ∂ÿßÿ° ÿßŸÑÿ≠ÿµÿ±Ÿäÿ©', en: 'Access to the exclusive members library' },
            'original-price': { ar: 'ÿßŸÑÿ≥ÿπÿ± ÿßŸÑÿ£ÿµŸÑŸä', en: 'Original Price' },
            'preorder-price': { ar: 'ÿ≥ÿπÿ± ÿßŸÑÿ≠ÿ¨ÿ≤ ÿßŸÑŸÖÿ≥ÿ®ŸÇ', en: 'Pre-order Price' },
            'form-title': { ar: 'ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ∑ŸÑÿ® ŸàÿßŸÑÿØŸÅÿπ', en: 'Order and Payment Information' },
            'label-name': { ar: 'ÿßŸÑÿßÿ≥ŸÖ ÿßŸÑŸÉÿßŸÖŸÑ', en: 'Full Name' },
            'label-email': { ar: 'ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä (ŸÑÿ™ŸÑŸÇŸä ÿßŸÑŸÉÿ™ÿßÿ®)', en: 'Email (to receive the book)' },
            'label-country': { ar: 'ÿßŸÑÿØŸàŸÑÿ© (ŸÑŸÑÿ¥ÿ≠ŸÜ)', en: 'Country (for shipping)' },
            'label-agree': { ar: 'ÿ£ŸàÿßŸÅŸÇ ÿπŸÑŸâ ÿßŸÑÿ¥ÿ±Ÿàÿ∑ ŸàÿßŸÑÿ£ÿ≠ŸÉÿßŸÖ Ÿà ÿ≥Ÿäÿßÿ≥ÿ© ÿßŸÑÿÆÿµŸàÿµŸäÿ©.', en: 'I agree to the Terms, Conditions, and Privacy Policy.' },
            'btn-confirm': { ar: 'ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ≠ÿ¨ÿ≤ ŸàÿßŸÑÿØŸÅÿπ', en: 'Confirm Pre-order & Pay' },
            'note-shipment': { ar: '*ÿ≥Ÿäÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑŸÉÿ™ÿßÿ® ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä ÿÆŸÑÿßŸÑ Ÿ¢Ÿ§ ÿ≥ÿßÿπÿ©. ÿßŸÑŸÜÿ≥ÿÆ ÿßŸÑŸàÿ±ŸÇŸäÿ© ÿ™Ÿèÿ¥ÿ≠ŸÜ ŸÅŸä ŸÖÿßÿ±ÿ≥ Ÿ¢Ÿ†Ÿ¢Ÿ¶.', en: '*E-book will be sent within 24 hours. Physical copies ship in March 2026.' },
            'footer-copy': { ar: '¬© 2025 ÿßŸÑŸÖÿ±ÿ≥ÿßÿ© ÿßŸÑÿ±ŸÇŸÖŸäÿ©. ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÇ ŸÖÿ≠ŸÅŸàÿ∏ÿ©.', en: '¬© 2025 Digital Anchor. All Rights Reserved.' }
        };

        // =====================================
        // 2. ÿ®ŸäÿßŸÜÿßÿ™ ÿ£ÿ≥ÿπÿßÿ± ÿßŸÑÿµÿ±ŸÅ (ŸÖÿπ ÿßŸÑŸäŸàÿ±Ÿà EUR)
        // =====================================
        const EXCHANGE_RATES = {
            'SAR': { rate: 3.75, symbol: 'ÿ±.ÿ≥', placement: 'after' },
            'USD': { rate: 1.0, symbol: '$', placement: 'before' },    
            'AED': { rate: 3.67, symbol: 'ÿØ.ÿ•', placement: 'after' },
            'EUR': { rate: 1.10, symbol: '‚Ç¨', placement: 'before' }   
        };
        const SAR_RATE = EXCHANGE_RATES['SAR'].rate; 
        
        const BASE_PRICE_SAR = 99;
        const ORIGINAL_PRICE_SAR = 149;

        // =====================================
        // 3. ÿßŸÑÿ≥ŸäÿßŸÇ ŸàÿßŸÑÿÆÿ∑ÿßŸÅÿßÿ™ (Language Provider)
        // =====================================
        const LanguageContext = createContext();

        function useTranslation() {
            return useContext(LanguageContext);
        }

        function LanguageProvider({ children }) {
            const [currentLang, setCurrentLang] = useState(localStorage.getItem('preferredLang') || 'ar');
            const [currentCurrency, setCurrentCurrency] = useState(localStorage.getItem('preferredCurrency') || 'SAR');

            useEffect(() => {
                localStorage.setItem('preferredLang', currentLang);
                document.documentElement.setAttribute('dir', currentLang === 'ar' ? 'rtl' : 'ltr');
                document.documentElement.setAttribute('lang', currentLang);
                
                const titleKey = document.head.querySelector('title')?.getAttribute('data-key') || 'page-title';
                document.title = ALL_TRANSLATIONS[titleKey]?.[currentLang] || ALL_TRANSLATIONS[titleKey]?.['ar'] || 'Digital Anchor';
            }, [currentLang]);

            const t = useMemo(() => (key) => {
                return ALL_TRANSLATIONS[key]?.[currentLang] || ALL_TRANSLATIONS[key]?.['ar'] || `[${key}]`;
            }, [currentLang]);

            const convertPrice = (basePriceSAR) => {
                const target = EXCHANGE_RATES[currentCurrency];
                if (!target || isNaN(basePriceSAR)) return `${basePriceSAR} SAR`;

                const priceInUSD = basePriceSAR / SAR_RATE;
                
                const decimalPlaces = (currentCurrency === 'SAR' || currentCurrency === 'AED') ? 0 : 2;
                const newPrice = (priceInUSD * target.rate).toFixed(decimalPlaces); 
                
                const symbol = target.symbol;
                
                return target.placement === 'before' ? `${symbol}${newPrice}` : `${newPrice} ${symbol}`;
            };

            const setCurrency = (currencyCode) => {
                setCurrentCurrency(currencyCode);
                localStorage.setItem('preferredCurrency', currencyCode);
            };

            const contextValue = {
                t,
                currentLang,
                setLang: setCurrentLang,
                currentCurrency,
                setCurrency,
                convertPrice,
                EXCHANGE_RATES,
                SAR_RATE
            };

            return (
                <LanguageContext.Provider value={contextValue}>
                    {children}
                </LanguageContext.Provider>
            );
        }

        // =====================================
        // 4. ŸÖŸÉŸàŸÜ NavBar ÿßŸÑŸÖŸàÿ≠ÿØ (AR/EN + 4 Currencies)
        // =====================================
        const NavBar = () => {
            const { t, setLang, currentLang, currentCurrency, setCurrency, EXCHANGE_RATES } = useTranslation();
            
            const availableLangs = ['ar', 'en'];
            
            return (
                <nav className="bg-white shadow-md sticky top-0 z-50">
                    <div className="container mx-auto px-4 py-3 flex justify-between items-center">
                        <div className="flex items-center space-x-3">
                            <i className="fas fa-anchor text-xl text-anchor-gold"></i>
                            <h1 className="text-2xl font-bold text-anchor-blue">{t('site-logo')}</h1>
                        </div>
                        
                        <div className="flex items-center space-x-6">
                            {/* üåê ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑŸÑÿ∫ÿ© (AR/EN ŸÅŸÇÿ∑) üåê */}
                            <div className="flex items-center space-x-1 border border-gray-300 rounded-full p-1">
                                {availableLangs.map(lang => (
                                    <button 
                                        key={lang}
                                        onClick={() => setLang(lang)} 
                                        className={`text-sm font-bold px-3 py-1 rounded-full 
                                            ${currentLang === lang ? 'bg-anchor-blue text-white' : 'text-gray-700 hover:bg-gray-100'} transition`}
                                    >
                                        {lang === 'ar' ? 'ÿπ' : 'En'}
                                    </button>
                                ))}
                            </div>
                            
                            {/* üíµ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿπŸÖŸÑÿ© (SAR, USD, AED, EUR) üíµ */}
                            <select 
                                value={currentCurrency} 
                                onChange={(e) => setCurrency(e.target.value)}
                                className="text-gray-700 font-medium border border-gray-300 rounded-lg p-2 transition"
                            >
                                {Object.keys(EXCHANGE_RATES).map(code => (
                                    <option key={code} value={code}>
                                        {EXCHANGE_RATES[code].symbol} ({code})
                                    </option>
                                ))}
                            </select>

                            {/* ÿ±Ÿàÿßÿ®ÿ∑ ÿßŸÑÿ™ŸÜŸÇŸÑ */}
                            <a href="index.html" className="text-gray-700 hover:text-anchor-gold font-medium transition">{t('nav-home')}</a>
                            <a href="guide.html" className="text-gray-700 hover:text-anchor-gold font-medium transition">{t('nav-guide')}</a>
                            <a href="resources.html" className="text-gray-700 hover:text-anchor-gold font-medium transition">{t('nav-resources')}</a>
                            <a href="members.html" className="text-gray-700 hover:text-anchor-gold font-medium transition">{t('nav-members')}</a>
                            <a href="book-preorder.html" className="bg-anchor-gold text-anchor-blue px-4 py-2 rounded-lg font-bold hover:bg-yellow-400 transition shadow-md">{t('nav-buy')}</a>
                        </div>
                    </div>
                </nav>
            );
        };

        const PreorderPage = () => {
            const { t, convertPrice } = useTranslation();
            
            return (
                <div className="flex flex-col min-h-screen">
                    <NavBar />

                    <main className="flex-grow container mx-auto px-4 py-12 max-w-6xl">
                        <header className="text-center mb-10">
                            <h1 className="text-4xl font-extrabold text-anchor-blue mb-2">{t('header-title')}</h1>
                            <p className="text-xl text-gray-600">{t('header-subtitle')}</p>
                        </header>

                        <div className="grid lg:grid-cols-2 gap-10 bg-white p-8 rounded-xl shadow-2xl border-t-4 border-anchor-gold">
                            
                            {/* Product Info Column */}
                            <div>
                                <h2 className="text-3xl font-bold text-anchor-blue mb-4">{t('product-title')}</h2>
                                <img src="images/book-mockup.png" alt="Book Mockup" className="w-full h-auto rounded-lg shadow-xl mb-6"/>
                                
                                <ul className="space-y-3 text-lg text-gray-700">
                                    <li className="flex items-start">
                                        <i className="fas fa-check-circle text-anchor-green ml-3 mt-1 text-xl"></i>
                                        {t('product-feature-1')}
                                    </li>
                                    <li className="flex items-start">
                                        <i className="fas fa-book text-anchor-gold ml-3 mt-1 text-xl"></i>
                                        {t('product-feature-2')}
                                    </li>
                                    <li className="flex items-start">
                                        <i className="fas fa-lock-open text-anchor-blue ml-3 mt-1 text-xl"></i>
                                        {t('product-feature-3')}
                                    </li>
                                </ul>

                                {/* Pricing Section - Uses convertPrice() */}
                                <div className="mt-8 pt-4 border-t border-gray-200">
                                    <div className="text-sm text-gray-400 line-through mb-1">
                                        {t('original-price')}: {convertPrice(ORIGINAL_PRICE_SAR)}
                                    </div>
                                    <div className="text-2xl font-semibold text-anchor-blue mb-2">
                                        {t('preorder-price')}:
                                    </div>
                                    <div className="text-6xl font-extrabold text-red-600">
                                        {convertPrice(BASE_PRICE_SAR)}
                                    </div>
                                </div>
                            </div>
                            
                            {/* Form Column */}
                            <div className="bg-gray-50 p-6 rounded-lg shadow-inner">
                                <h3 className="text-2xl font-bold text-anchor-blue mb-6 border-b pb-3">{t('form-title')}</h3>
                                
                                <form action="thank-you-preorder.html" method="POST" className="space-y-5">
                                    
                                    <div>
                                        <label htmlFor="name" className="block text-sm font-medium text-gray-700 mb-1">{t('label-name')}</label>
                                        <input type="text" id="name" name="name" required 
                                            className="w-full p-3 border border-gray-300 rounded-lg focus:ring-anchor-gold focus:border-anchor-gold transition" />
                                    </div>
                                    
                                    <div>
                                        <label htmlFor="email" className="block text-sm font-medium text-gray-700 mb-1">{t('label-email')}</label>
                                        <input type="email" id="email" name="email" required 
                                            className="w-full p-3 border border-gray-300 rounded-lg focus:ring-anchor-gold focus:border-anchor-gold transition" />
                                    </div>
                                    
                                    <div>
                                        <label htmlFor="country" className="block text-sm font-medium text-gray-700 mb-1">{t('label-country')}</label>
                                        <input type="text" id="country" name="country" required 
                                            className="w-full p-3 border border-gray-300 rounded-lg focus:ring-anchor-gold focus:border-anchor-gold transition" />
                                    </div>
                                    
                                    <div className="flex items-center pt-2">
                                        <input id="agree" name="agree" type="checkbox" required
                                            className="h-4 w-4 text-anchor-blue border-gray-300 rounded focus:ring-anchor-gold" />
                                        <label htmlFor="agree" className="mr-2 block text-sm text-gray-900 cursor-pointer">
                                            {t('label-agree')}
                                        </label>
                                    </div>

                                    <p className="text-xs text-gray-500 pt-4">{t('note-shipment')}</p>
                                    
                                    <button type="submit" className="w-full bg-anchor-gold text-anchor-blue py-3 rounded-lg font-bold text-xl hover:bg-yellow-400 transition shadow-lg">
                                        {t('btn-confirm')}
                                    </button>
                                </form>
                            </div>
                        </div>
                    </main>

                    <footer className="bg-anchor-blue text-slate-400 py-8 text-center">
                        <div className="max-w-4xl mx-auto px-6">
                            <hr className="border-slate-700 mb-8"/>
                            <p className="text-sm">
                                {t('footer-copy')}
                            </p>
                        </div>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<LanguageProvider><PreorderPage /></LanguageProvider>);
    </script>
</body>
</html>